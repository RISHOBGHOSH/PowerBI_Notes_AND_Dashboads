USE DATABASE DEMO_DATABASE;

CREATE OR REPLACE TABLE RG_SALES_ORDER
(
ORDERNUMBER VARCHAR (15),
ORDERDATE DATE,
CUSTOMER_INDEX INT PRIMARY KEY,
CHANNEL VARCHAR(15),
WAREHOUSE_CODE VARCHAR (15),
DELIVERY_REGION_INDEX INT NOT NULL,
PRODUCT_INDEX INT NOT NULL,
ORDER_QTY INT,
UNIT_PRICE_USD NUMBER(7,2),
TOTAL_REVENUE_USD NUMBER (7,2),
TOTAL_UNIT_COST_USD NUMBER (7,2);



SELECT * FROM RG_CUSTOMER_NAME;
SELECT * FROM RG_REGIONS;
SELECT * FROM RG_PRODUCTS;
SELECT * FROM RG_SALES_ORDER;

CREATE OR REPLACE VIEW RG_CUST_SALES_ORDER_VW AS
  SELECT A.*B.PRODUCT_NAME,C.CITY,C.COUNTRY,C.CITY ||'-'||COUNTRY AS FULL_NAME,D.CUSTOMERNAMES
  FROM RG_SALES_ORDER A
  LEFT OUTER JOIN RG_PRODUCTS B ON A.PRODUCT_INDEX = B.PRODUCTINDEX
  LEFT OUTER JOIN RG_REGIONS C ON A.DELIVERY_REGION_INDEX = C.REGIONINDEX
  LEFT OUTER JOIN RG_CUSTOMER_NAME D ON A.CUSTOMER_INDEX = D.CUSTOMER_INDEX;
  
DESCRIBE VIEW RG_CUST_SALES_ORDER_VW;

SELECT * FROM RG_CUST_SALES_ORDER_VW;

SELECT * FROM AJ_CUST_SALES_ORDER_VW WHERE ORDERNUMBER IS NULL;

---------------------------EDA---------------------------------------------

SELECT CHANNEL,COUNT(ORDERNUMBER) FROM RG_CUST_SALES_ORDER_VW
 GROUP BY 1
 ORDER BY 1;
 
 ----CITY AND COUNTRY I NEED TO CLUB INTO NEW COLUMN-----------------
 
 SELECT CITY ||'-'||COUNTRY AS CITY_COUNTRY
    FROM RG_CUST_SALES_ORDER_VW;
  
  